wandb: Using wandb-core as the SDK backend. Please refer to https://wandb.me/wandb-core for more information.
wandb: Currently logged in as: anumafzal (background-tool). Use `wandb login --relogin` to force relogin
wandb: Appending key for api.wandb.ai to your netrc file: /home/aafzal/.netrc
/home/aafzal/ToTpred/py3.10/lib/python3.10/site-packages/accelerate/utils/modeling.py:1462: UserWarning: Current model requires 4224 bytes of buffer for offloaded layers, which seems does not fit any GPU's remaining memory. If you are experiencing a OOM later, please consider using offload_buffers=True.
  warnings.warn(
Token is valid (permission: write).
Your token has been saved in your configured git credential helpers (store).
Your token has been saved to /home/aafzal/.cache/huggingface/token
Login successful
Loading .env was:  True
CUDA AVAILABLE....
Starting Script with config: {'dataset': 'openai/gsm8k', 'samples': 158, 'max_new_tokens': 256, 'batch_size': 1, 'model_hf_key': 'meta-llama/Meta-Llama-3.1-8B-Instruct', 'exec_kwargs': {}, 'load_in_8bit': False, 'load_in_4bit': True, 'device_map': 'auto', 'read_from_file': True, 'filename': 'runs/openai-gsm8k/2024-10-08_20-00-58/openai-gsm8k.xlsx', 'regression_features_saved': False, 'regression_features_path': 'path.xlsx', 'togetherai': True, 'verbose': False}
{'dataset': 'openai/gsm8k', 'samples': 158, 'max_new_tokens': 256, 'batch_size': 1, 'model_hf_key': 'meta-llama/Meta-Llama-3.1-8B-Instruct', 'exec_kwargs': {}, 'load_in_8bit': False, 'load_in_4bit': True, 'device_map': 'auto', 'read_from_file': True, 'filename': 'runs/openai-gsm8k/2024-10-08_20-00-58/openai-gsm8k.xlsx', 'regression_features_saved': False, 'regression_features_path': 'path.xlsx', 'togetherai': True, 'verbose': False}
Index(['Question', 'Reference', 'Prediction', 'llm_decisions',
       'anum_decisions'],
      dtype='object')
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:00<00:00,  4.01it/s]Loading checkpoint shards:  50%|█████     | 2/4 [00:00<00:00,  4.15it/s]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:00<00:00,  4.31it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:00<00:00,  4.53it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:00<00:00,  4.40it/s]
Generating Features of regression model
  0%|          | 0/158 [00:00<?, ?it/s]Starting from v4.46, the `logits` model output will have the same type as the model (except at train time, where it will always be FP32)
  1%|          | 1/158 [00:19<51:02, 19.51s/it]  1%|▏         | 2/158 [00:39<51:12, 19.69s/it]  2%|▏         | 3/158 [00:58<50:19, 19.48s/it]  3%|▎         | 4/158 [01:18<50:09, 19.54s/it]  3%|▎         | 5/158 [01:37<49:19, 19.34s/it]  4%|▍         | 6/158 [01:56<49:05, 19.38s/it]  4%|▍         | 7/158 [02:15<48:31, 19.28s/it]  5%|▌         | 8/158 [02:34<47:55, 19.17s/it]  6%|▌         | 9/158 [02:53<47:32, 19.14s/it]  6%|▋         | 10/158 [03:13<47:34, 19.29s/it]  7%|▋         | 11/158 [03:32<47:22, 19.34s/it]  8%|▊         | 12/158 [03:51<46:46, 19.22s/it]  8%|▊         | 13/158 [04:11<46:38, 19.30s/it]  9%|▉         | 14/158 [04:30<46:20, 19.31s/it]  9%|▉         | 15/158 [04:49<46:01, 19.31s/it] 10%|█         | 16/158 [05:09<45:58, 19.43s/it] 11%|█         | 17/158 [05:29<45:42, 19.45s/it] 11%|█▏        | 18/158 [05:48<45:28, 19.49s/it] 12%|█▏        | 19/158 [06:08<45:07, 19.48s/it] 13%|█▎        | 20/158 [06:27<44:38, 19.41s/it] 13%|█▎        | 21/158 [06:46<44:03, 19.29s/it] 14%|█▍        | 22/158 [07:05<43:56, 19.39s/it] 15%|█▍        | 23/158 [07:25<43:25, 19.30s/it] 15%|█▌        | 24/158 [07:44<42:54, 19.21s/it] 16%|█▌        | 25/158 [08:03<43:00, 19.40s/it] 16%|█▋        | 26/158 [08:23<42:49, 19.47s/it] 17%|█▋        | 27/158 [08:43<42:37, 19.52s/it] 18%|█▊        | 28/158 [09:02<42:24, 19.57s/it] 18%|█▊        | 29/158 [09:22<41:58, 19.52s/it] 19%|█▉        | 30/158 [09:41<41:28, 19.44s/it] 20%|█▉        | 31/158 [10:01<41:19, 19.52s/it] 20%|██        | 32/158 [10:20<40:44, 19.40s/it] 21%|██        | 33/158 [10:39<40:23, 19.39s/it] 22%|██▏       | 34/158 [10:58<39:47, 19.25s/it] 22%|██▏       | 35/158 [11:17<39:20, 19.19s/it] 23%|██▎       | 36/158 [11:36<39:02, 19.20s/it] 23%|██▎       | 37/158 [11:56<38:42, 19.19s/it] 24%|██▍       | 38/158 [12:15<38:22, 19.19s/it] 25%|██▍       | 39/158 [12:35<38:21, 19.34s/it] 25%|██▌       | 40/158 [12:54<38:14, 19.45s/it] 26%|██▌       | 41/158 [13:14<37:52, 19.43s/it] 27%|██▋       | 42/158 [13:33<37:36, 19.45s/it] 27%|██▋       | 43/158 [13:53<37:25, 19.53s/it] 28%|██▊       | 44/158 [14:12<37:02, 19.49s/it] 28%|██▊       | 45/158 [14:32<36:42, 19.49s/it] 29%|██▉       | 46/158 [14:51<36:17, 19.44s/it] 30%|██▉       | 47/158 [15:10<35:50, 19.37s/it] 30%|███       | 48/158 [15:29<35:24, 19.31s/it] 31%|███       | 49/158 [15:49<35:03, 19.30s/it] 32%|███▏      | 50/158 [16:08<34:57, 19.42s/it] 32%|███▏      | 51/158 [16:28<34:32, 19.37s/it] 33%|███▎      | 52/158 [16:47<34:18, 19.42s/it] 34%|███▎      | 53/158 [17:06<33:51, 19.35s/it] 34%|███▍      | 54/158 [17:26<33:36, 19.39s/it] 35%|███▍      | 55/158 [17:45<32:56, 19.19s/it] 35%|███▌      | 56/158 [18:04<32:35, 19.17s/it] 36%|███▌      | 57/158 [18:23<32:23, 19.25s/it] 37%|███▋      | 58/158 [18:42<32:01, 19.22s/it] 37%|███▋      | 59/158 [19:01<31:41, 19.21s/it] 38%|███▊      | 60/158 [19:21<31:29, 19.28s/it] 39%|███▊      | 61/158 [19:40<31:04, 19.22s/it] 39%|███▉      | 62/158 [19:59<30:48, 19.25s/it] 40%|███▉      | 63/158 [20:19<30:34, 19.31s/it] 41%|████      | 64/158 [20:38<30:15, 19.31s/it] 41%|████      | 65/158 [20:57<29:48, 19.23s/it] 42%|████▏     | 66/158 [21:16<29:17, 19.10s/it] 42%|████▏     | 67/158 [21:35<29:07, 19.21s/it] 43%|████▎     | 68/158 [21:55<28:50, 19.23s/it] 44%|████▎     | 69/158 [22:14<28:28, 19.20s/it] 44%|████▍     | 70/158 [22:33<28:13, 19.25s/it] 45%|████▍     | 71/158 [22:53<27:59, 19.30s/it] 46%|████▌     | 72/158 [23:12<27:52, 19.45s/it] 46%|████▌     | 73/158 [23:32<27:31, 19.43s/it] 47%|████▋     | 74/158 [23:51<27:06, 19.36s/it] 47%|████▋     | 75/158 [24:11<26:56, 19.48s/it] 48%|████▊     | 76/158 [24:30<26:30, 19.40s/it] 49%|████▊     | 77/158 [24:49<26:13, 19.43s/it] 49%|████▉     | 78/158 [25:09<25:57, 19.47s/it] 50%|█████     | 79/158 [25:28<25:33, 19.41s/it] 51%|█████     | 80/158 [25:48<25:16, 19.44s/it] 51%|█████▏    | 81/158 [26:07<25:01, 19.50s/it] 52%|█████▏    | 82/158 [26:27<24:37, 19.44s/it] 53%|█████▎    | 83/158 [26:46<24:13, 19.39s/it] 53%|█████▎    | 84/158 [27:05<23:52, 19.36s/it] 54%|█████▍    | 85/158 [27:25<23:38, 19.43s/it] 54%|█████▍    | 86/158 [27:44<23:14, 19.37s/it] 55%|█████▌    | 87/158 [28:03<22:52, 19.33s/it] 56%|█████▌    | 88/158 [28:23<22:41, 19.45s/it] 56%|█████▋    | 89/158 [28:43<22:27, 19.54s/it] 57%|█████▋    | 90/158 [29:02<22:00, 19.42s/it] 58%|█████▊    | 91/158 [29:21<21:42, 19.44s/it] 58%|█████▊    | 92/158 [29:41<21:27, 19.51s/it] 59%|█████▉    | 93/158 [30:00<21:00, 19.39s/it] 59%|█████▉    | 94/158 [30:19<20:22, 19.10s/it] 60%|██████    | 95/158 [30:38<20:07, 19.16s/it] 61%|██████    | 96/158 [30:57<19:55, 19.29s/it] 61%|██████▏   | 97/158 [31:17<19:32, 19.21s/it] 62%|██████▏   | 98/158 [31:36<19:13, 19.23s/it] 63%|██████▎   | 99/158 [31:55<18:52, 19.20s/it] 63%|██████▎   | 100/158 [32:14<18:33, 19.20s/it] 64%|██████▍   | 101/158 [32:34<18:19, 19.29s/it] 65%|██████▍   | 102/158 [32:53<17:56, 19.22s/it] 65%|██████▌   | 103/158 [33:12<17:37, 19.23s/it] 66%|██████▌   | 104/158 [33:32<17:26, 19.37s/it] 66%|██████▋   | 105/158 [33:51<17:11, 19.46s/it] 67%|██████▋   | 106/158 [34:11<16:57, 19.57s/it] 68%|██████▊   | 107/158 [34:30<16:32, 19.47s/it] 68%|██████▊   | 108/158 [34:50<16:10, 19.41s/it] 69%|██████▉   | 109/158 [35:09<15:49, 19.37s/it] 70%|██████▉   | 110/158 [35:28<15:32, 19.42s/it] 70%|███████   | 111/158 [35:48<15:12, 19.41s/it] 71%|███████   | 112/158 [36:07<14:54, 19.44s/it] 72%|███████▏  | 113/158 [36:27<14:34, 19.44s/it] 72%|███████▏  | 114/158 [36:46<14:15, 19.45s/it] 73%|███████▎  | 115/158 [37:06<13:54, 19.40s/it] 73%|███████▎  | 116/158 [37:25<13:34, 19.39s/it] 74%|███████▍  | 117/158 [37:44<13:12, 19.33s/it] 75%|███████▍  | 118/158 [38:04<12:56, 19.40s/it] 75%|███████▌  | 119/158 [38:23<12:36, 19.39s/it] 76%|███████▌  | 120/158 [38:42<12:14, 19.34s/it] 77%|███████▋  | 121/158 [39:01<11:53, 19.29s/it] 77%|███████▋  | 122/158 [39:21<11:35, 19.31s/it] 78%|███████▊  | 123/158 [39:40<11:15, 19.31s/it] 78%|███████▊  | 124/158 [39:59<10:57, 19.32s/it] 79%|███████▉  | 125/158 [40:18<10:33, 19.21s/it] 80%|███████▉  | 126/158 [40:37<10:12, 19.15s/it] 80%|████████  | 127/158 [40:57<09:53, 19.15s/it] 81%|████████  | 128/158 [41:16<09:33, 19.13s/it] 82%|████████▏ | 129/158 [41:35<09:15, 19.15s/it] 82%|████████▏ | 130/158 [41:53<08:51, 18.99s/it] 83%|████████▎ | 131/158 [42:13<08:38, 19.20s/it] 84%|████████▎ | 132/158 [42:33<08:22, 19.33s/it] 84%|████████▍ | 133/158 [42:52<08:01, 19.25s/it] 85%|████████▍ | 134/158 [43:11<07:41, 19.22s/it] 85%|████████▌ | 135/158 [43:31<07:24, 19.33s/it] 86%|████████▌ | 136/158 [43:50<07:07, 19.44s/it] 87%|████████▋ | 137/158 [44:10<06:49, 19.49s/it] 87%|████████▋ | 138/158 [44:29<06:27, 19.35s/it] 88%|████████▊ | 139/158 [44:48<06:07, 19.34s/it] 89%|████████▊ | 140/158 [45:07<05:47, 19.31s/it] 89%|████████▉ | 141/158 [45:27<05:29, 19.39s/it] 90%|████████▉ | 142/158 [45:46<05:10, 19.41s/it] 91%|█████████ | 143/158 [46:05<04:48, 19.26s/it] 91%|█████████ | 144/158 [46:24<04:28, 19.15s/it] 92%|█████████▏| 145/158 [46:43<04:08, 19.14s/it] 92%|█████████▏| 146/158 [47:03<03:50, 19.21s/it] 93%|█████████▎| 147/158 [47:22<03:31, 19.26s/it] 94%|█████████▎| 148/158 [47:41<03:12, 19.22s/it] 94%|█████████▍| 149/158 [48:01<02:52, 19.21s/it] 95%|█████████▍| 150/158 [48:20<02:34, 19.26s/it] 96%|█████████▌| 151/158 [48:39<02:14, 19.25s/it] 96%|█████████▌| 152/158 [48:58<01:55, 19.29s/it] 97%|█████████▋| 153/158 [49:18<01:36, 19.21s/it] 97%|█████████▋| 154/158 [49:37<01:17, 19.31s/it] 98%|█████████▊| 155/158 [49:56<00:57, 19.31s/it] 99%|█████████▊| 156/158 [50:16<00:38, 19.35s/it] 99%|█████████▉| 157/158 [50:35<00:19, 19.30s/it]100%|██████████| 158/158 [50:54<00:00, 19.33s/it]100%|██████████| 158/158 [50:54<00:00, 19.33s/it]
torch.Size([158, 4096])
Saved Regression Features at /home/aafzal/ToTpred/runs/openai-gsm8k/2024-10-08_20-44-07/regression_features.txt
Saved Regression Labels at /home/aafzal/ToTpred/runs/openai-gsm8k/2024-10-08_20-44-07/regression_labels.txt
Accuracy: 0.8679245283018868
              precision    recall  f1-score   support

         0.0       0.25      0.20      0.22         5
         1.0       0.92      0.94      0.93        48

    accuracy                           0.87        53
   macro avg       0.58      0.57      0.58        53
weighted avg       0.86      0.87      0.86        53

